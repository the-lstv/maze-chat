<body>
    <script>
        if(location.search == "?result=success" && location.hash.startsWith("#")){
            // I KNOW this is BAD, *VERY* BAD, but shut up ill fix it someday lol
            localStorage["==temporary.2226b75"] = location.hash.replace("#", "");

            (async function(){

                let profile = await(await fetch((location.origin.endsWith("test")? "http://api.extragon.test/v2/mazec": "https://api.extragon.cloud/v2/mazec") + "/user/create_profile/", {
                    headers: {
                        Authorization: location.hash.replace("#", "")
                    }
                })).json()

                if(!profile || (profile.error && profile.code !== 25)) {
                    console.error(profile)
                    document.querySelector("h3").innerHTML = "<b>Sorry, something went wrong while setting up your profile.</b><br><br>You can:<br><li>Refresh the page to try again</li><li>Contact me with a screenshot/copy of any errors in the console (ctrl+shift+c)</li><li style=color:red>Warning: Do not share the URL of this page with anyone, it might contain sensitive information.</li>"
                } else location.replace("/")
            })()
        } else {
            alert(`Sorry! An unknown error has occured while trying to log you in (here's all we know: ${location.search})`)
            location.replace("/")
        }
    </script>

    <style>
        :root {
            background-color: #111;
            color: #fff;
        }

        html, body {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: sans-serif;
        }
    </style>

    <h3>
        Finishing up, please wait...
    </h3>
</body>